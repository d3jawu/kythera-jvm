package me.dejawu.kythera;

import me.dejawu.kythera.runtime.InternalTypeValue;
import me.dejawu.kythera.runtime.KytheraValue;
import me.dejawu.kythera.runtime.TypeValueStore;

import java.util.function.Function;

// this class is used to test runtime constructs and examine generated bytecode
public class Scratch {
    public static void main(String[] args) {
        KytheraValue noncapturingLambda = KytheraValue.getFnValue((fnArgs) -> {
            System.out.println(fnArgs[0]);
            return fnArgs[0];
        }, (InternalTypeValue) TypeValueStore.getFnType(new KytheraValue[]{KytheraValue.INT}, KytheraValue.ROOT_TYPE).value);

        ((Function) noncapturingLambda.value).apply(new KytheraValue[]{KytheraValue.getIntValue(2)});

        KytheraValue x = KytheraValue.getIntValue(3);

        KytheraValue capturingLambda = KytheraValue.getFnValue((fnArgs) -> {
            System.out.println(x);
            return x;
        }, (InternalTypeValue) TypeValueStore.getFnType(new KytheraValue[]{}, KytheraValue.ROOT_TYPE).value);

        ((Function) capturingLambda.value).apply(new KytheraValue[]{});
    }
}
